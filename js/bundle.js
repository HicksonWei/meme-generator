"use strict";var fileName,fileType,topText=document.getElementById("topText"),topTextSize=document.getElementById("topTextSize"),topTextColor=document.getElementById("topTextColor"),topTextStroke=document.getElementById("topTextStroke"),topTextFont=document.getElementById("topTextFont"),topTextBg=document.getElementById("topTextBg"),bottomText=document.getElementById("bottomText"),bottomTextSize=document.getElementById("bottomTextSize"),bottomTextColor=document.getElementById("bottomTextColor"),bottomTextStroke=document.getElementById("bottomTextStroke"),bottomTextFont=document.getElementById("bottomTextFont"),bottomTextBg=document.getElementById("bottomTextBg"),modalBg=document.querySelector(".modal-bg"),modal=document.querySelector(".modal"),modalClose=document.querySelector(".modal-close"),modalContent=document.querySelector(".modal-content"),btnOK=document.querySelector(".btn_ok"),btnTop=document.querySelector(".btn_top"),rootElement=document.documentElement,imgPreviewDiv=document.getElementById("imgPreviewDiv"),uploadBtnBlock=document.getElementById("uploadBtnBlock"),sizeHint=document.getElementById("sizeHint"),btnGroupDiv=document.getElementById("btnGroupDiv"),imgUpload=document.getElementById("imgUpload"),imgRenew=document.getElementById("imgRenew"),imgDownload=document.getElementById("imgDownload"),loading=document.getElementById("loading"),canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),topFont="Acme",bottomFont="Acme",bgArr=["transparent","black","white"],topBg="transparent",bottomBg="transparent",img=new Image;function init(){canvas.width=0,canvas.height=0,imgUpload.addEventListener("change",function(){var t=this.files[0];if(t){if(3<t.size/1024/1024)return showAlert("The file size exceeds the maximum limit (3MB)."),void(this.value=null);if("image/jpeg"!=t.type&&"image/png"!=t.type)return showAlert("Invalid file type."),void(this.value=null);var e=new FileReader;e.addEventListener("load",function(){loading.classList.add("active"),img.onload=function(){loading.classList.remove("active"),1.78<img.width/img.height||img.width/img.height<.56?showAlert("Invalid width/height ratio. (16:9 ~ 9:16)"):(canvas.width=img.width,canvas.height=img.height,imgPreviewDiv.style.minHeight="auto",imgPreviewDiv.style.minWidth="auto",imgPreviewDiv.style.width="auto",uploadBtnBlock.style.display="none",btnGroupDiv.style.display="flex",sizeHint.style.display="block",sizeHint.innerText="Original size: ".concat(img.width," × ").concat(img.height),fileName=t.name,fileType=t.type,canvasRender())},img.src=e.result}),e.readAsDataURL(t)}}),imgRenew.addEventListener("change",function(){var t=this.files[0];if(t){if(3<t.size/1024/1024)return showAlert("The file size exceeds the maximum limit (3MB)."),void(this.value=null);if("image/jpeg"!=t.type&&"image/png"!=t.type)return showAlert("Invalid file type."),void(this.value=null);var e=new FileReader;e.addEventListener("load",function(){loading.classList.add("active"),img.onload=function(){loading.classList.remove("active"),1.78<img.width/img.height||img.width/img.height<.56?showAlert("Invalid width/height ratio. (16:9 ~ 9:16)"):(canvas.width=img.width,canvas.height=img.height,sizeHint.innerText="Original size: ".concat(img.width," × ").concat(img.height),fileName=t.name,fileType=t.type,canvasRender())},img.src=e.result}),e.readAsDataURL(t)}}),imgDownload.addEventListener("click",function(){var t=document.createElement("a");t.download=fileName,"image/jpeg"===fileType&&(t.href=canvas.toDataURL("image/jpeg")),"image/png"===fileType&&(t.href=canvas.toDataURL("image/png")),t.click()}),modalClose.addEventListener("click",hideAlert),btnOK.addEventListener("click",hideAlert),btnTop.addEventListener("click",function(){rootElement.scrollTo({top:0,behavior:"smooth"})}),document.addEventListener("scroll",function(){var t=rootElement.scrollHeight-rootElement.clientHeight;.4<=rootElement.scrollTop/t?btnTop.classList.add("show"):btnTop.classList.remove("show")})}function canvasRenderListener(t,e,n){t.addEventListener(e,function(t){n&&n(t),img.src&&canvasRender()})}function bgSwitch(t,e){var n=this,o=bgArr.findIndex(function(t){return t===n[e]});this[e]=2<=o?bgArr[0]:bgArr[o+1],t.innerText=this[e],t.classList=[],t.classList.add(this[e])}function fontSwitch(t,e){this[t]=e}function showAlert(t){modalBg.classList.add("show"),modalContent.innerText=t}function hideAlert(){modalBg.classList.remove("show")}function canvasRender(){var n;ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(img,0,0),ctx.strokeStyle="#ffffff",ctx.textAlign="center",n=canvas.width*topTextSize.value,ctx.fillStyle=topBg,ctx.fillRect(0,0,canvas.width,""!=topText.value.split("\n")[0]?topText.value.split("\n").length*n+40:0),ctx.fillStyle=topTextColor.value,ctx.strokeStyle=topTextStroke.checked?"black":topTextColor.value,ctx.font="".concat(n,"px ").concat(topFont),ctx.lineWidth=2,ctx.textBaseline="top",topText.value.split("\n").forEach(function(t,e){ctx.fillText(t,canvas.width/2,e*n+30,canvas.width),ctx.strokeText(t,canvas.width/2,e*n+30,canvas.width)}),n=canvas.width*bottomTextSize.value,ctx.fillStyle=bottomBg,ctx.fillRect(0,canvas.height,canvas.width,""!=bottomText.value.split("\n")[0]?-(bottomText.value.split("\n").length*n+60):0),ctx.fillStyle=bottomTextColor.value,ctx.strokeStyle=bottomTextStroke.checked?"black":bottomTextColor.value,ctx.font="".concat(n,"px ").concat(bottomFont),ctx.lineWidth=2,ctx.textBaseline="bottom",bottomText.value.split("\n").reverse().forEach(function(t,e){ctx.fillText(t,canvas.width/2,canvas.height-e*n-30,canvas.width),ctx.strokeText(t,canvas.width/2,canvas.height-e*n-30,canvas.width)})}init(),canvasRenderListener(topText,"input"),canvasRenderListener(topTextSize,"input"),canvasRenderListener(topTextColor,"input"),canvasRenderListener(topTextStroke,"change"),canvasRenderListener(topTextFont,"change",function(t){return fontSwitch.call(window,"topFont",t.target.value)}),canvasRenderListener(topTextBg,"click",function(t){return bgSwitch.call(window,topTextBg,"topBg")}),canvasRenderListener(bottomText,"input"),canvasRenderListener(bottomTextSize,"input"),canvasRenderListener(bottomTextColor,"input"),canvasRenderListener(bottomTextStroke,"change"),canvasRenderListener(bottomTextFont,"change",function(t){fontSwitch.call(window,"bottomFont",t.target.value)}),canvasRenderListener(bottomTextBg,"click",function(t){return bgSwitch.call(window,bottomTextBg,"bottomBg")});
//# sourceMappingURL=bundle.js.map
